steps:
  - template: utils/use-node.yml

  - script: yarn install
    workingDirectory: web
    displayName: Install dependencies

  - script: yarn clean
    workingDirectory: web
    displayName: Clean world

  - script: yarn build
    workingDirectory: web
    displayName: Build world

  - task: CopyFiles@2
    inputs:
      SourceFolder: '$(System.DefaultWorkingDirectory)'
      Contents: |
        web/index.html
        web/_bundle/*
      TargetFolder: '$(Build.ArtifactStagingDirectory)'

  - task: PublishPipelineArtifact@0
    displayName: "Publish Artifact: website"
    inputs:
      targetPath: "$(Build.ArtifactStagingDirectory)"
      artifactName: website